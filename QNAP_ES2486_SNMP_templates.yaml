zabbix_export:
  version: '6.4'
  template_groups:
    - uuid: 36bff6c29af64692839d077febfc7079
      name: 'Templates/Network devices'
  templates:
    - uuid: 2f0097c9b44643d8a60fac15e5950e40
      template: 'Template SNMP QNAP2'
      name: 'Template SNMP QNAP2'
      templates:
        - name: 'Template Module Generic SNMP'
      groups:
        - name: 'Templates/Network devices'
      items:
        - uuid: 5bdb8bf9d01649a8bbb3cda034f3303e
          name: 'CPU: Temperature'
          type: SNMP_AGENT
          snmp_oid: iso.3.6.1.4.1.24681.2.2.5.1
          key: cpu.temp
          delay: 30m
          history: 7d
          trends: 7d
          preprocessing:
            - type: RTRIM
              parameters:
                - ' C'
          tags:
            - tag: component
              value: system
          triggers:
            - uuid: 51afe29c68064207a01cb42a7ea541f2
              expression: 'min(/Template SNMP QNAP2/cpu.temp,15m)>={$CPU_TEMPERATURE_ALARM}'
              name: 'High CPU temperature (>{$CPU_TEMPERATURE_ALARM} for 15m)'
              opdata: 'Current temperature: {ITEM.VALUE}'
              priority: WARNING
              description: 'The CPU temperature is exceeding the threshold.'
        - uuid: 11caaf09f6d648c59efed95074d3e302
          name: Hostname
          type: SNMP_AGENT
          snmp_oid: iso.3.6.1.4.1.24681.2.2.13.0
          key: host.name
          delay: 1h
          history: 2w
          trends: '0'
          value_type: CHAR
          description: |
            MIB: SNMPv2-MIB
            An administratively-assigned name for this managed node.By convention, this is the node's fully-qualified domain name.  If the name is unknown, the value is the zero-length string.
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          tags:
            - tag: Application
              value: General
        - uuid: 404cd084caf0470292118e9e9199f88a
          name: 'Load average (1m avg)'
          type: SNMP_AGENT
          snmp_oid: iso.3.6.1.4.1.24681.2.2.1.3
          key: 'system.cpu.load.avg1[laLoad.1]'
          history: 7d
          value_type: FLOAT
          description: 'MIB: UCD-SNMP-MIB'
          preprocessing:
            - type: RTRIM
              parameters:
                - ' %'
          tags:
            - tag: Application
              value: CPU
        - uuid: 16751bd220f24324aa005c8e95cb7dfb
          name: 'Load average (5m avg)'
          type: SNMP_AGENT
          snmp_oid: 'iso.3.6.1.4.1.24681.2.2.1.3["index","iso.3.6.1.4.1.24681.2.2.1.2", "Load-5"]'
          key: 'system.cpu.load.avg5[laLoad.2]'
          history: 7d
          value_type: FLOAT
          description: 'MIB: UCD-SNMP-MIB'
          tags:
            - tag: Application
              value: CPU
        - uuid: 3a2ef08cf65d4e269a7d0ec135854801
          name: 'Load average (15m avg)'
          type: SNMP_AGENT
          snmp_oid: '1.3.6.1.4.1.2021.10.1.3["index","1.3.6.1.4.1.2021.10.1.2", "Load-15"]'
          key: 'system.cpu.load.avg15[laLoad.3]'
          history: 7d
          value_type: FLOAT
          description: 'MIB: UCD-SNMP-MIB'
          tags:
            - tag: Application
              value: CPU
        - uuid: 9597b8095fd542fb8c9effe1ee627dbe
          name: 'System: Firmware update available'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.55062.1.12.7.0
          key: system.firmware.update.available
          delay: 1h
          history: 7d
          trends: 7d
          status: DISABLED
          tags:
            - tag: component
              value: health
            - tag: component
              value: system
          triggers:
            - uuid: f216acc7a7614d149295e6369ee8865c
              expression: 'last(/Template SNMP QNAP2/system.firmware.update.available)=1'
              name: 'A firmware update is available'
              priority: INFO
              description: 'A new firmware update is available to install. It is recommended to update accordingly.'
              manual_close: 'YES'
        - uuid: a4565f9aa13f4e2daca3e52514c58406
          name: 'System: Serial no.'
          type: SNMP_AGENT
          snmp_oid: iso.3.6.1.4.1.24681.2.2.26.0
          key: system.serial.number
          delay: 2h
          history: 7d
          trends: '0'
          value_type: TEXT
          inventory_link: SERIALNO_A
          tags:
            - tag: component
              value: system
        - uuid: 5245352f777f43bea2569e10f38a6657
          name: 'System: Temperature'
          type: SNMP_AGENT
          snmp_oid: iso.3.6.1.4.1.24681.2.2.6.1
          key: system.temp
          delay: 30m
          history: 7d
          trends: 7d
          preprocessing:
            - type: RTRIM
              parameters:
                - ' C'
          tags:
            - tag: component
              value: system
        - uuid: e287770a3feb4a7da5d22e4ed2a7dbc4
          name: 'System: Uptime'
          type: SNMP_AGENT
          snmp_oid: iso.3.6.1.4.1.24681.2.2.4.0
          key: system.uptime
          delay: 10m
          units: uptime
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '0.01'
          tags:
            - tag: component
              value: system
        - uuid: a381d5501cae493d96c83e98b6726ca9
          name: 'Free memory'
          type: SNMP_AGENT
          snmp_oid: iso.3.6.1.4.1.24681.2.2.3.0
          key: 'vm.memory.free[memAvailReal.0]'
          history: 7d
          units: B
          preprocessing:
            - type: RTRIM
              parameters:
                - ' MB'
          tags:
            - tag: Application
              value: Memory
        - uuid: 571155f946c14f658d43cf13f7f4bebe
          name: 'Total memory'
          type: SNMP_AGENT
          snmp_oid: iso.3.6.1.4.1.24681.2.2.2.0
          key: 'vm.memory.total[memTotalReal.0]'
          history: 7d
          units: GB
          preprocessing:
            - type: RTRIM
              parameters:
                - MB
            - type: MULTIPLIER
              parameters:
                - '0.0009765625'
          tags:
            - tag: Application
              value: Memory
        - uuid: 36030b2e723e48e0a5302fc4cf9e2351
          name: 'Memory utilization'
          type: CALCULATED
          key: 'vm.memory.util[snmp]'
          history: 7d
          value_type: FLOAT
          units: '%'
          params: '(last(//vm.memory.total[memTotalReal.0])-(last(//vm.memory.free[memAvailReal.0])))/last(//vm.memory.total[memTotalReal.0])*100'
          description: 'Please note that memory utilization is a rough estimate, since memory available is calculated as free+buffers+cached, which is not 100% accurate, but the best we can get using SNMP.'
          tags:
            - tag: Application
              value: Memory
      discovery_rules:
        - uuid: f9b3b8d0d19e48628709ab37380f34e7
          name: 'Disk Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#HDDINDEX},iso.3.6.1.4.1.24681.2.2.11.1.1,{#HDDSLOT},iso.3.6.1.4.1.24681.2.2.11.1.2]'
          key: disk.discovery
          delay: 15m
          item_prototypes:
            - uuid: 37fbb8725d3c4f128dbdf067451fb33b
              name: 'HDD {#HDDSLOT}: Capacity'
              type: SNMP_AGENT
              snmp_oid: 'iso.3.6.1.4.1.24681.2.2.11.1.6.{#HDDINDEX}'
              key: 'hdd.capacity[{#HDDINDEX}]'
              delay: 1h
              history: 7d
              trends: 7d
              value_type: FLOAT
              units: B
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      const re = /([-+]?[0-9]*\.?[0-9]*)([TGM].*B)/;
                      var array = re.exec(value);
                      var unit = array[2];
                      switch (unit) {
                        case "TB":
                          var result = array[1] * 1048576;
                          break;
                        case "GB":
                          var result = array[1] * 1024;
                          break;
                        case "MB":
                          var result = array[1];
                          break;
                        case "KB":
                          var result = array[1] / 1024;
                          break;
                      }
                      return result;
                - type: MULTIPLIER
                  parameters:
                    - '1048576'
              tags:
                - tag: component
                  value: disk
            - uuid: 34dbf1b6ea244fe7acf739cf9f481ba4
              name: 'HDD {#HDDSLOT}: IOPS'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.24681.1.4.1.11.5.6.2.1.3.{#HDDINDEX}'
              key: 'hdd.iops[{#HDDINDEX}]'
              delay: 5m
              history: 7d
              trends: 7d
              status: DISABLED
              discover: NO_DISCOVER
            - uuid: 3b0990183e064beb8509a4363fd35823
              name: 'HDD {#HDDSLOT}: Latency'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.24681.1.4.1.11.5.6.2.1.4.{#HDDINDEX}'
              key: 'hdd.latency[{#HDDINDEX}]'
              delay: 5m
              history: 7d
              trends: 7d
              status: DISABLED
              discover: NO_DISCOVER
              trigger_prototypes:
                - uuid: 08098e97f8734e7abbc401840f323b44
                  expression: 'min(/Template SNMP QNAP2/hdd.latency[{#HDDINDEX}],15m)>{$DISK_LATENCY_ALARM}'
                  name: 'Disk latency is high (>{$DISK_LATENCY_ALARM}ms for 15 m) on HDD {#HDDSLOT}'
                  opdata: 'Current latency: {ITEM.VALUE}'
                  status: DISABLED
                  discover: NO_DISCOVER
                  priority: AVERAGE
                  description: 'The latency of the disk is higher than the threshhold for 15 minutes.'
                  manual_close: 'YES'
            - uuid: 329236a4c7fb485c9e9830adef377895
              name: 'HDD {#HDDSLOT}: Model'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.24681.2.2.11.1.5.{#HDDINDEX}'
              key: 'hdd.model[{#HDDINDEX}]'
              delay: 1h
              history: 7d
              trends: '0'
              value_type: TEXT
              tags:
                - tag: component
                  value: disk
            - uuid: 4e362b27982a4322b58b050777494d4c
              name: 'HDD {#HDDSLOT}: Serial no.'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.24681.2.2.11.1.9.{#HDDINDEX}'
              key: 'hdd.serial[{#HDDINDEX}]'
              delay: 1h
              history: 7d
              trends: '0'
              value_type: CHAR
              description: 'Returns the serial number of disk (e.g: S2AM8ZSB).'
            - uuid: b0f97d677f7844ed973daf2fe8960929
              name: 'HDD {#HDDSLOT}: Smart Info'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.24681.2.2.11.1.7.{#HDDINDEX}'
              key: 'hdd.smart[{#HDDINDEX}]'
              delay: 5m
              history: 7d
              trends: '0'
              value_type: TEXT
              tags:
                - tag: component
                  value: disk
                - tag: component
                  value: health
            - uuid: d81a7cb1e14f4420bd9a65373cd38c36
              name: 'HDD {#HDDSLOT}: State'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.24681.2.2.11.1.4.{#HDDINDEX}'
              key: 'hdd.state[{#HDDINDEX}]'
              delay: 5m
              history: 7d
              trends: '0'
              value_type: CHAR
              tags:
                - tag: component
                  value: disk
                - tag: component
                  value: health
              trigger_prototypes:
                - uuid: 4a9f53b210584ab58be1c541bd95a951
                  expression: 'find(/Template SNMP QNAP2/hdd.state[{#HDDINDEX}],,"regexp","Error")=1'
                  name: 'Critical state of HDD {#HDDSLOT}'
                  opdata: 'Current state: {ITEM.VALUE}'
                  priority: DISASTER
                  description: 'QTS has detected a critical error. You must replace the disk immediately.'
                - uuid: 9209e7560c3346ef8a707d2bdf0dd40e
                  expression: 'find(/Template SNMP QNAP2/hdd.state[{#HDDINDEX}],,"regexp","Warning")=1'
                  name: 'Faulty state of HDD {#HDDSLOT}'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: HIGH
                  description: 'QTS has detected an error. Please, run a full S.M.A.R.T test and a disk scan as soon as possible.'
            - uuid: 55d7734590be4dd2b4838410c4a9e932
              name: 'HDD {#HDDSLOT}: Temperature'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.24681.2.2.11.1.3.{#HDDINDEX}'
              key: 'hdd.temp[{#HDDINDEX}]'
              delay: 5m
              history: 7d
              trends: 7d
              units: °C
              preprocessing:
                - type: REGEX
                  parameters:
                    - '([^ ]+) .*'
                    - \1
                  error_handler: DISCARD_VALUE
              tags:
                - tag: component
                  value: disk
                - tag: component
                  value: health
              trigger_prototypes:
                - uuid: 81155b469c544cc090760a3773968f4e
                  expression: 'avg(/Template SNMP QNAP2/hdd.temp[{#HDDINDEX}],15m)>{$HDD_TEMPERATURE_ALARM} + 5'
                  name: 'Temperature of HDD {#HDDSLOT} is critical for 15m'
                  opdata: 'Current temperature: {ITEM.VALUE}'
                  priority: HIGH
                  description: 'Temperature of disk is higher than the threshold for 15 minutes.'
                - uuid: cea1849861184940975009b94cf9e661
                  expression: 'avg(/Template SNMP QNAP2/hdd.temp[{#HDDINDEX}],15m)>{$HDD_TEMPERATURE_ALARM}'
                  name: 'Temperature of HDD {#HDDSLOT} is excessive for 15m'
                  opdata: 'Current temperature: {ITEM.VALUE}'
                  priority: WARNING
                  description: 'Temperature of disk is higher than the threshold for 15 minutes.'
                  dependencies:
                    - name: 'Temperature of HDD {#HDDSLOT} is critical for 15m'
                      expression: 'avg(/Template SNMP QNAP2/hdd.temp[{#HDDINDEX}],15m)>{$HDD_TEMPERATURE_ALARM} + 5'
            - uuid: 5db1f2f6e777425588d5509e7b5c56d2
              name: 'HDD {#HDDSLOT}: Type'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.24681.2.2.11.1.10.{#HDDINDEX}'
              key: 'hdd.type[{#HDDINDEX}]'
              delay: 5m
              history: 7d
              trends: '0'
              value_type: TEXT
              tags:
                - tag: component
                  value: disk
                - tag: component
                  value: health
        - uuid: 15e7e22e94274bca984283467a15815d
          name: 'FAN Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#FANINDEX},.1.3.6.1.4.1.24681.2.2.15.1.1,{#FANNAME},.1.3.6.1.4.1.24681.2.2.15.1.2]'
          key: fan.discovery
          delay: 15m
          item_prototypes:
            - uuid: dee6bda5aeb3454ab1b1fc96001a4068
              name: '{#FANNAME}: Speed'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.24681.2.2.15.1.3.{#FANINDEX}'
              key: 'fan.speed[{#FANINDEX}]'
              delay: 30m
              history: 7d
              trends: 7d
              tags:
                - tag: component
                  value: system
        - uuid: 9185e62e6d514cc584acbbc80cf80fd3
          name: 'LUN Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#LUNINDEX},.1.3.6.1.4.1.24681.2.2.19.1.1,{#LUNNAME},.1.3.6.1.4.1.24681.2.2.19.1.2]'
          key: lun.discovery
          delay: 15m
          item_prototypes:
            - uuid: ae48a90e648b4e95bd05e8282dc1c183
              name: 'LUN {#LUNNAME}: Capacity'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.24681.2.2.19.1.3.{#LUNINDEX}'
              key: 'lun.capacity[{#LUNINDEX}]'
              delay: 1h
              history: 7d
              trends: 7d
              value_type: FLOAT
              units: B
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      const re = /([-+]?[0-9]*\.?[0-9]*\s)([TGM].*B)/;
                      var array = re.exec(value);
                      var unit = array[2];
                      switch (unit) {
                        case "TB":
                          var result = array[1] * 1048576;
                          break;
                        case "GB":
                          var result = array[1] * 1024;
                          break;
                        case "MB":
                          var result = array[1];
                          break;
                        case "KB":
                          var result = array[1] / 1024;
                          break;
                      }
                      return result;
                - type: MULTIPLIER
                  parameters:
                    - '1048576'
              tags:
                - tag: component
                  value: lun
            - uuid: 8431adc4a01a4a05a19e49caa04bccca
              name: 'LUN {#LUNNAME}: Used size'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.24681.2.2.19.1.4.{#LUNINDEX}'
              key: 'lun.free[{#LUNINDEX}]'
              history: 7d
              trends: 7d
              value_type: FLOAT
              units: B
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      const re = /([-+]?[0-9]*\.?[0-9]*\s)([TGM].*B)/;
                      var array = re.exec(value);
                      var unit = array[2];
                      switch (unit) {
                        case "TB":
                          var result = array[1] * 1048576;
                          break;
                        case "GB":
                          var result = array[1] * 1024;
                          break;
                        case "MB":
                          var result = array[1];
                          break;
                        case "KB":
                          var result = array[1] / 1024;
                          break;
                      }
                      return result;
                - type: MULTIPLIER
                  parameters:
                    - '1048576'
              tags:
                - tag: component
                  value: health
                - tag: component
                  value: lun
            - uuid: cf8ebf996a9b4afda17f0c958ee9c774
              name: 'LUN {#LUNNAME}: IOPS Read'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.24681.2.2.19.1.7.{#LUNINDEX}'
              key: 'lun.iops.read[{#LUNINDEX}]'
              delay: 1h
              history: 7d
              trends: 7d
              value_type: FLOAT
              units: IOPS
              tags:
                - tag: component
                  value: lun
            - uuid: bf5322d966b947f2ab9a10a1df523e14
              name: 'LUN {#LUNNAME}: IOPS Write'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.24681.2.2.19.1.8.{#LUNINDEX}'
              key: 'lun.iops.write[{#LUNINDEX}]'
              delay: 1h
              history: 7d
              trends: 7d
              value_type: FLOAT
              units: IOPS
              tags:
                - tag: component
                  value: lun
            - uuid: 944078494c9c40bdbabaef58c9b8501f
              name: 'LUN {#LUNNAME}: Latency Read'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.24681.2.2.19.1.9.{#LUNINDEX}'
              key: 'lun.latency.read[{#LUNINDEX}]'
              delay: 1h
              history: 7d
              trends: 7d
              value_type: FLOAT
              tags:
                - tag: component
                  value: lun
            - uuid: 13d3a7d3d94a48eb8b7a5fc11777748c
              name: 'LUN {#LUNNAME}: Latency Write'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.24681.2.2.19.1.10.{#LUNINDEX}'
              key: 'lun.latency.write[{#LUNINDEX}]'
              delay: 1h
              history: 7d
              trends: 7d
              value_type: FLOAT
              tags:
                - tag: component
                  value: lun
            - uuid: d3731a914445429b894aaf5373e812b8
              name: 'LUN {#LUNNAME}: Status'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.24681.2.2.19.1.5.{#LUNINDEX}'
              key: 'lun.status[{#LUNINDEX}]'
              delay: 15m
              history: 7d
              trends: '0'
              value_type: CHAR
              tags:
                - tag: component
                  value: health
                - tag: component
                  value: iscsi
              trigger_prototypes:
                - uuid: 9f78957f533b427e8ee36ec30e5c8c2d
                  expression: 'find(/Template SNMP QNAP2/lun.status[{#LUNINDEX}],,"regexp","online|in-use")=0'
                  name: 'Faulty state of  LUN: {#LUNNAME}'
                  opdata: 'Current state: {ITEM.VALUE}'
                  priority: HIGH
                  description: 'The LUN is not enabled or unmapped.'
        - uuid: 877a76687ac04753849c0b4f41be61ee
          name: 'Network interfaces discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#IFINDEX},.1.3.6.1.4.1.24681.2.2.9.1.1,{#IFNAME},.1.3.6.1.4.1.24681.2.2.9.1.2]'
          key: network.discovery
          delay: 15m
          filter:
            conditions:
              - macro: '{#IFNAME}'
                value: '{$NET_IF_MATCHES}'
                formulaid: A
          item_prototypes:
            - uuid: 7b0848e3a411410f8f381ad205a496db
              name: 'Interface {#IFNAME}: ErrorPackets'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.24681.2.2.9.1.5.{#IFINDEX}'
              key: 'net.if.errors[{#IFINDEX}]'
              delay: 5m
              history: 7d
              trends: 7d
              units: bps
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: component
                  value: network
            - uuid: a5f45cbbe1684e01994316113a5566e0
              name: 'Interface {#IFNAME}: Bits received'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.24681.2.2.9.1.3.{#IFINDEX}'
              key: 'net.if.received[{#IFINDEX}]'
              delay: 5m
              history: 7d
              trends: 7d
              units: bps
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: component
                  value: network
            - uuid: cf40c9e7515947b48c197bf0cfd90f50
              name: 'Interface {#IFNAME}: Bits sent'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.24681.2.2.9.1.4.{#IFINDEX}'
              key: 'net.if.sent[{#IFINDEX}]'
              delay: 5m
              history: 7d
              trends: 7d
              units: bps
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: component
                  value: network
        - uuid: a51982110b574b9cb2fc65665f60d7cb
          name: 'Pool Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#POOLINDEX},.1.3.6.1.4.1.24681.2.2.23.1.1,{#POOLNAME},.1.3.6.1.4.1.24681.2.2.23.1.2]'
          key: pool.discovery
          delay: 15m
          item_prototypes:
            - uuid: 30109bde96ee4a8186497009018709b6
              name: 'Pool {#POOLINDEX}: Capacity'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.24681.2.2.23.1.3.{#POOLINDEX}'
              key: 'pool.capacity[{#POOLINDEX}]'
              delay: 15m
              history: 7d
              trends: 7d
              value_type: FLOAT
              units: B
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      const re = /([-+]?[0-9]*\.?[0-9]*\s)([TGM].*B)/;
                      var array = re.exec(value);
                      var unit = array[2];
                      switch (unit) {
                        case "TB":
                          var result = array[1] * 1048576;
                          break;
                        case "GB":
                          var result = array[1] * 1024;
                          break;
                        case "MB":
                          var result = array[1];
                          break;
                        case "KB":
                          var result = array[1] / 1024;
                          break;
                      }
                      return result;
                - type: MULTIPLIER
                  parameters:
                    - '1048576'
              tags:
                - tag: component
                  value: pool
            - uuid: e63ec383256c43678f5e7976b2f03153
              name: 'Pool {#POOLINDEX}: Free size in %'
              type: CALCULATED
              key: 'pool.freepercentage[{#POOLINDEX}]'
              delay: 15m
              history: 7d
              trends: 7d
              value_type: FLOAT
              params: 'last(//pool.freeSize[{#POOLINDEX}])/last(//pool.capacity[{#POOLINDEX}])*100'
              tags:
                - tag: component
                  value: pool
              trigger_prototypes:
                - uuid: 2b02f655055c48ffaac5964818ba2cdc
                  expression: 'last(/Template SNMP QNAP2/pool.freepercentage[{#POOLINDEX}])<{$POOL_SIZE_ALARM}'
                  name: 'Reaching threshold for pool {#POOLINDEX} (<{$POOL_SIZE_ALARM}%)'
                  opdata: 'Current %: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: 'The free size of the pool is reaching the threshold.'
                  manual_close: 'YES'
            - uuid: af2b738503504c1b945a9ca1b475239f
              name: 'Pool {#POOLINDEX}: Free size'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.24681.2.2.23.1.4.{#POOLINDEX}'
              key: 'pool.freeSize[{#POOLINDEX}]'
              delay: 15m
              history: 7d
              trends: 7d
              value_type: FLOAT
              units: B
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      const re = /([-+]?[0-9]*\.?[0-9]*\s)([TGMKB].*B|B)/;
                      var array = re.exec(value);
                      var unit = array[2];
                      switch (unit) {
                        case "TB":
                          var result = array[1] * 1048576;
                          break;
                        case "GB":
                          var result = array[1] * 1024;
                          break;
                        case "MB":
                          var result = array[1];
                          break;
                        case "KB":
                          var result = array[1] / 1024;
                          break;
                        case "B":
                          var result = array[1] / 1048576;
                          break;
                      }
                      return result;
                - type: MULTIPLIER
                  parameters:
                    - '1048576'
              tags:
                - tag: component
                  value: pool
            - uuid: 269134602de547ea83b457267773d63b
              name: 'Pool {#POOLINDEX}: Status'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.24681.2.2.23.1.5.{#POOLINDEX}'
              key: 'pool.status[{#POOLINDEX}]'
              delay: 15m
              history: 7d
              trends: '0'
              value_type: CHAR
              tags:
                - tag: component
                  value: health
                - tag: component
                  value: pool
              trigger_prototypes:
                - uuid: 7c7b175e282d4083a861580d5c9c5dce
                  expression: 'find(/Template SNMP QNAP2/pool.status[{#POOLINDEX}],,"iregexp","^online")=0'
                  name: 'Faulty state of Pool {#POOLINDEX}'
                  priority: HIGH
                  description: 'A faulty state has been reported by the pool.'
        - uuid: 69689b8372ae40d79d9208d6d9382a88
          name: 'Power Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#POWERINDEX},.1.3.6.1.4.1.24681.2.2.21.1.1]'
          key: power.discovery
          delay: 1h
          item_prototypes:
            - uuid: c1f557c647ee4ad69240fb566314b649
              name: 'Power {#POWERINDEX}: FanSpeed'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.24681.2.2.21.1.5.{#POWERINDEX}'
              key: 'power.fanspeed[{#POWERINDEX}]'
              delay: 5m
              history: 7d
              trends: 7d
              units: '%'
            - uuid: 1059c6ce791743f2b2e0e76c6ce447ee
              name: 'Power {#POWERINDEX}: Status'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.24681.2.2.21.1.4.{#POWERINDEX}'
              key: 'power.status[{#POWERINDEX}]'
              delay: 5m
              history: 7d
              trends: 7d
              units: '%'
              preprocessing:
                - type: REGEX
                  parameters:
                    - OK
                    - '1'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              trigger_prototypes:
                - uuid: d4839b29d29c48ca97247eda3c137e12
                  expression: 'find(/Template SNMP QNAP2/power.status[{#POWERINDEX}],,"regexp","Error")=1'
                  name: 'Critical state of POWER {#POWERINDEX}'
                  opdata: 'Current state: {ITEm.VALUE}'
                  priority: DISASTER
                - uuid: df2c5177d090414396e97459373499ab
                  expression: 'find(/Template SNMP QNAP2/power.status[{#POWERINDEX}],,"regexp","Warning")=1'
                  name: 'Faulty state of POWER {#POWERINDEX}'
                  opdata: 'Current state: {ITEm.VALUE}'
                  priority: HIGH
            - uuid: b35867b9bf92446cb577321b762ff949
              name: 'Power {#POWERINDEX}: Temperature'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.24681.2.2.21.1.6.{#POWERINDEX}'
              key: 'power.temperature[{#POWERINDEX}]'
              delay: 5m
              history: 7d
              trends: 7d
              units: '%'
              preprocessing:
                - type: RTRIM
                  parameters:
                    - C
              trigger_prototypes:
                - uuid: a4bccda26f8f4116b4e8a7bd9838a6ac
                  expression: 'avg(/Template SNMP QNAP2/power.temperature[{#POWERINDEX}],15m)>{$POWER_TEMPERATURE_ALARM} + 5'
                  name: 'Temperature of POWER {#POWERINDEX} is critical for 15m'
                  opdata: 'Current.temperature {ITEM.VALUE}'
                  priority: HIGH
        - uuid: f1903cb30d82410bb499b2f0dc8219cf
          name: 'Volume Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#VOLUMEINDEX},.1.3.6.1.4.1.24681.2.2.17.1.1,{#VOLUMENAME},.1.3.6.1.4.1.24681.2.2.17.1.2]'
          key: volume.discovery
          delay: 15m
          item_prototypes:
            - uuid: b38820481bad4439ac526ff3c1931d15
              name: 'Volume {#VOLUMENAME}: Capacity'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.24681.2.2.17.1.3.{#VOLUMEINDEX}'
              key: 'volume.capacity[{#VOLUMEINDEX}]'
              delay: 15m
              history: 7d
              trends: 7d
              value_type: FLOAT
              units: B
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      const re = /([-+]?[0-9]*\.?[0-9]*\s)([TGM].*B)/;
                      var array = re.exec(value);
                      var unit = array[2];
                      switch (unit) {
                        case "TB":
                          var result = array[1] * 1048576;
                          break;
                        case "GB":
                          var result = array[1] * 1024;
                          break;
                        case "MB":
                          var result = array[1];
                          break;
                        case "KB":
                          var result = array[1] / 1024;
                          break;
                      }
                      return result;
                - type: MULTIPLIER
                  parameters:
                    - '1048576'
              tags:
                - tag: component
                  value: volume
            - uuid: a1dec952a1594095927c833bb9f53ca8
              name: 'Volume {#VOLUMENAME}: Free size in %'
              type: CALCULATED
              key: 'volume.freePercentage[{#VOLUMEINDEX}]'
              delay: 15m
              history: 7d
              trends: 7d
              params: 'last(//volume.freeSize[{#VOLUMEINDEX}])/last(//volume.capacity[{#VOLUMEINDEX}])*100'
              tags:
                - tag: component
                  value: volume
              trigger_prototypes:
                - uuid: 5986c3af211f4e3887dbe8651e13e9c9
                  expression: 'last(/Template SNMP QNAP2/volume.freePercentage[{#VOLUMEINDEX}])<{$VOLUME_SIZE_ALARM}'
                  name: 'Reaching threshold for volume {#VOLUMENAME} (<{$VOLUME_SIZE_ALARM}%)'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: 'The free size of the volume is reaching the threshold.'
            - uuid: cafda13f64aa419aaf2a7fe6400dd49b
              name: 'Volume {#VOLUMENAME}: Free size'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.24681.2.2.17.1.4.{#VOLUMEINDEX}'
              key: 'volume.freeSize[{#VOLUMEINDEX}]'
              delay: 15m
              history: 7d
              trends: 7d
              units: B
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      const re = /([-+]?[0-9]*\.?[0-9]*\s)([TGMKB].*B|B)/;
                      var array = re.exec(value);
                      var unit = array[2];
                      switch (unit) {
                        case "TB":
                          var result = array[1] * 1048576;
                          break;
                        case "GB":
                          var result = array[1] * 1024;
                          break;
                        case "MB":
                          var result = array[1];
                          break;
                        case "KB":
                          var result = array[1] / 1024;
                          break;
                        case "B":
                          var result = array[1] / 1048576;
                          break;
                      }
                      return result;
                - type: MULTIPLIER
                  parameters:
                    - '1048576'
              tags:
                - tag: component
                  value: volume
            - uuid: 3c94435819fa47a5ad62c033f4be95a7
              name: 'Volume {#VOLUMENAME}: Status'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.24681.2.2.17.1.5.{#VOLUMEINDEX}'
              key: 'volume.status[{#VOLUMEINDEX}]'
              delay: 15m
              history: 7d
              trends: '0'
              value_type: TEXT
              tags:
                - tag: component
                  value: health
                - tag: component
                  value: volume
              trigger_prototypes:
                - uuid: b036155d30a342c79715765806eb1a77
                  expression: 'find(/Template SNMP QNAP2/volume.status[{#VOLUMEINDEX}],,"iregexp","^online")=0'
                  name: 'Faulty state of volume {#VOLUMENAME}'
                  opdata: 'Current state: {ITEM.VALUE}'
                  priority: DISASTER
                  description: 'Volume is in a faulty state. Check as soon as possible.'
      macros:
        - macro: '{$CPU_TEMPERATURE_ALARM}'
          value: '65'
          description: 'Amount in centigrade when an alarm shall be raised'
        - macro: '{$DISK_LATENCY_ALARM}'
          value: '30'
          description: 'Amount in ms when an alarm shall be raised'
        - macro: '{$HDD_TEMPERATURE_ALARM}'
          value: '50'
          description: 'Amount in centigrade when an alarm shall be raised'
        - macro: '{$NET_IF_MATCHES}'
          value: '^.*$'
          description: 'Regex matches for network interfaces discovery. Matches to the inteface desc which is (eth0, eth1, etc)'
        - macro: '{$POOL_SIZE_ALARM}'
          value: '15'
          description: 'Amount in % when an alarm shall be raised'
        - macro: '{$POWER_TEMPERATURE_ALARM}'
          value: '50'
          description: 'Amount in centigrade when an alarm shall be raised'
        - macro: '{$SNMP.TIMEOUT}'
          value: 1m
          description: 'The time interval for SNMP agent availability trigger expression.'
      valuemaps:
        - uuid: cee5ce1c4fe84b688802343d1f319e58
          name: 'Alarm state'
          mappings:
            - value: '0'
              newvalue: Ok
            - value: '1'
              newvalue: Alarm
        - uuid: 3b8fc101d4934e7fabed277b53e0edaa
          name: 'Firmware Version Available'
          mappings:
            - value: '0'
              newvalue: 'No update available'
            - value: '1'
              newvalue: 'Update available'
        - uuid: 5685c40ee4c5497e90a862b3bf59da8a
          name: 'LUN Status'
          mappings:
            - value: '-1'
              newvalue: Offline
            - value: '0'
              newvalue: Disconnected
            - value: '1'
              newvalue: Connected
        - uuid: 5b64c3e78fdd4023b70593e2ffd62421
          name: 'S.M.A.R.T State'
          mappings:
            - value: '-1'
              newvalue: Error
            - value: '0'
              newvalue: Good
            - value: '1'
              newvalue: Warning
            - value: '2'
              newvalue: Abnormal
        - uuid: 00b596cc42ab40e99bfe49772d9825da
          name: 'Storage Pool Status'
          mappings:
            - value: '-6'
              newvalue: SED_LOCKED
            - value: '-5'
              newvalue: Detaching
            - value: '-4'
              newvalue: Removing
            - value: '-3'
              newvalue: Error
            - value: '-2'
              newvalue: 'Not ready'
            - value: '-1'
              newvalue: Warning
            - value: '0'
              newvalue: Ready
            - value: '1'
              newvalue: ENABLE_QTIER
            - value: '2'
              newvalue: SED_LOCKING
            - value: '3'
              newvalue: SED_UNLOCKING
